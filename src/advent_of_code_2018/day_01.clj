(ns advent-of-code-2018.day-01
  (:require [clojure.test :refer :all]
            [advent-of-code-2018.common :refer :all]))

(def input "-1\n-19\n-7\n-2\n-3\n+9\n-17\n+19\n+3\n+16\n+7\n-2\n+5\n+10\n-1\n+17\n-4\n+16\n+10\n-2\n+6\n-2\n-18\n+7\n-3\n+1\n+18\n-13\n+15\n-6\n+5\n-15\n-17\n-16\n+7\n+1\n-17\n-17\n-15\n+19\n+1\n+20\n+11\n-4\n+13\n-16\n-22\n-19\n-2\n-18\n+3\n+3\n+8\n-19\n-10\n+7\n-13\n-7\n+16\n-18\n-5\n-6\n+3\n-7\n-6\n-7\n+3\n-17\n-8\n+14\n-13\n+1\n-13\n-7\n+14\n-12\n-12\n-5\n-13\n-18\n+5\n+4\n-7\n-18\n-10\n-8\n+7\n-15\n-2\n-3\n+6\n-11\n-14\n+4\n-18\n+6\n-12\n-4\n+5\n+1\n+15\n+5\n-7\n+15\n+18\n-8\n+16\n+5\n+12\n+21\n+19\n+18\n+5\n+5\n-4\n-2\n-2\n-7\n+18\n-16\n+15\n+12\n-6\n+10\n-14\n+3\n+9\n-15\n-2\n+13\n+7\n+17\n+13\n+16\n-7\n+22\n-18\n-7\n+15\n-3\n+18\n-7\n-3\n+4\n-10\n+14\n-17\n-14\n-9\n+20\n-16\n-14\n-1\n-19\n+9\n-25\n-23\n-18\n-12\n-11\n+7\n-14\n+15\n-11\n-5\n+3\n+18\n+12\n+20\n+8\n-9\n-7\n+18\n-13\n-13\n+4\n+18\n+5\n-16\n-5\n+15\n-22\n+18\n-8\n-20\n-13\n-15\n-6\n-9\n-16\n+3\n+19\n-5\n+15\n+12\n+13\n-14\n+7\n-11\n+3\n-12\n-10\n+4\n-19\n+5\n-16\n-20\n-14\n-2\n+1\n-18\n-15\n-8\n+2\n-5\n+4\n+11\n+7\n+15\n-8\n-9\n-10\n+6\n+14\n+19\n-16\n+14\n+16\n-6\n+9\n+12\n+9\n+16\n-22\n-10\n-15\n-5\n+4\n+5\n-19\n-9\n-9\n+2\n-6\n-18\n+8\n+22\n-19\n+12\n-10\n-15\n-3\n+11\n+1\n-18\n-14\n-6\n-1\n-14\n-19\n+8\n-10\n+4\n+13\n+10\n+2\n-10\n-11\n-5\n-6\n+1\n+14\n-19\n-7\n-4\n-10\n-5\n+10\n+12\n+10\n+8\n-1\n+9\n+10\n+13\n+19\n-14\n+5\n+13\n-16\n+5\n+5\n+3\n+6\n-10\n+6\n+19\n+8\n+19\n-4\n-9\n+19\n+19\n+5\n+3\n+4\n-15\n+36\n-14\n-23\n-19\n-7\n+4\n+11\n+25\n-7\n+15\n-3\n+26\n-13\n+21\n+22\n-4\n+21\n+5\n-13\n+17\n-5\n-7\n+10\n+15\n-23\n+21\n+26\n+24\n-1\n-3\n-5\n+16\n+13\n-5\n-18\n-12\n+13\n-4\n+18\n+4\n-7\n+21\n-7\n+18\n-15\n-15\n-1\n+24\n+18\n-10\n+18\n+15\n+10\n-1\n+18\n+8\n-7\n-16\n+7\n-12\n+4\n-20\n-9\n+11\n+21\n-19\n+1\n-4\n-3\n-8\n+7\n-17\n+12\n+49\n-15\n-2\n+32\n+10\n+8\n-11\n-14\n+6\n+13\n-4\n-2\n+15\n-6\n+1\n+4\n+10\n+2\n-1\n+10\n+10\n-17\n+2\n+11\n-2\n+10\n+8\n-10\n+12\n+9\n+15\n-6\n-6\n-17\n+4\n+2\n+13\n+16\n-13\n-7\n+9\n+9\n-15\n+3\n-5\n+18\n+3\n+7\n-14\n-17\n-11\n-3\n-11\n+1\n-3\n+6\n+5\n+10\n+3\n-16\n-4\n+6\n+12\n+18\n+16\n+4\n+14\n-4\n+8\n+6\n-5\n-13\n-12\n+1\n-5\n+11\n+8\n-4\n-6\n+12\n+15\n+18\n+9\n+12\n+9\n-6\n+11\n-20\n+14\n-16\n-10\n+14\n+2\n-7\n-8\n-9\n-1\n+5\n+15\n-12\n-4\n-17\n-18\n+23\n+10\n-18\n+11\n+1\n-2\n-15\n-13\n-19\n-4\n-2\n-14\n+17\n+11\n-1\n-6\n+11\n+15\n+19\n-3\n+13\n-12\n-2\n-25\n+11\n+7\n+3\n+13\n+16\n+10\n+8\n-4\n+3\n-15\n-19\n+2\n+14\n-2\n+34\n+15\n-2\n+5\n-9\n+12\n+4\n-17\n+15\n-4\n+7\n+1\n+5\n+7\n+24\n-9\n-19\n+1\n-7\n+19\n-2\n-12\n+10\n-2\n+16\n-11\n-30\n-13\n+7\n-5\n-17\n-51\n-6\n-7\n-5\n-29\n-63\n+10\n-5\n-18\n-21\n-8\n+17\n-2\n-19\n+20\n-25\n-45\n-16\n-22\n-15\n+5\n-200\n-1\n+17\n-6\n-48\n-13\n+71\n-32\n+124\n+11\n-21\n-21\n-10\n+245\n+72\n-3\n+11\n-29\n+32\n+326\n+319\n+79928\n+18\n+15\n+16\n-8\n-3\n-8\n-10\n-7\n-14\n+16\n+13\n-5\n-11\n-19\n-4\n-19\n-17\n+19\n+11\n+12\n+1\n-14\n+9\n+14\n-4\n+9\n-3\n+10\n+7\n+15\n+14\n+16\n-15\n+5\n+11\n-2\n+3\n-16\n+12\n+19\n+3\n+2\n-1\n+4\n+5\n+14\n+15\n-7\n-9\n-14\n-5\n+15\n+19\n-8\n+19\n-6\n-3\n-6\n+7\n+1\n+9\n-5\n-19\n-19\n+12\n+8\n-3\n-19\n-3\n-12\n-7\n-10\n-6\n-7\n-15\n-14\n+8\n+15\n+1\n-19\n-15\n-13\n-18\n-5\n-10\n-11\n+2\n-14\n-14\n+12\n-6\n+7\n+16\n+6\n-18\n+13\n+16\n-7\n+20\n+10\n-21\n-17\n-12\n+3\n-17\n+18\n-19\n+14\n+14\n+17\n-11\n+5\n-7\n-16\n+4\n+17\n+12\n+13\n+14\n-6\n+12\n+17\n+11\n+14\n+6\n+12\n+4\n+4\n+6\n+16\n-4\n-19\n-16\n-4\n+18\n-2\n+8\n+21\n+14\n+2\n+14\n+5\n+17\n+2\n-4\n-9\n+10\n+2\n-14\n+18\n+4\n+16\n-15\n-19\n+17\n+7\n-3\n+10\n-4\n-11\n+19\n-5\n-17\n-16\n-3\n+1\n+8\n+12\n+5\n+16\n+16\n-1\n+18\n+11\n+10\n-19\n+5\n+10\n-4\n-14\n-8\n+2\n-8\n-17\n+2\n-14\n+16\n+12\n-5\n+25\n+18\n+8\n-14\n+18\n+13\n+18\n+5\n+12\n+13\n-17\n-5\n-7\n-12\n+1\n-6\n+7\n+7\n+9\n+19\n-14\n+3\n+16\n+15\n-18\n+17\n-6\n-14\n-11\n-15\n+19\n+11\n+11\n+2\n-4\n-16\n-20\n-5\n-11\n+1\n+5\n-17\n-4\n+9\n+8\n-5\n-21\n+15\n-14\n-19\n+10\n+22\n+18\n-16\n-6\n+13\n+18\n+17\n-4\n+11\n+7\n-13\n-10\n-1\n+9\n+18\n-13\n+20\n+15\n+6\n-3\n-7\n-4\n-4\n-11\n-13\n-14\n-16\n-19\n-19\n+15\n-10\n+8\n-19\n-8\n-20\n-5\n+9\n-1\n+19\n+15\n+1\n+20\n-13\n-19\n-9\n-15\n-19\n-10\n-5\n+19\n-10\n+12\n+22\n+8\n-4\n+17\n+14\n+14\n+14\n+11\n+26\n+18\n+13\n+17\n+8\n+15\n+12\n+8\n-12\n-11\n+7\n+9\n-2\n+14\n+14\n+13\n-2\n+14\n+7\n-4\n+3\n-10\n+8\n-13\n+14\n+6\n-16\n+14\n+3\n+13\n+10\n-18\n-4\n+13\n+18\n+17\n-12\n+14\n+17\n+2\n+12\n-10\n-3\n-14\n+21\n-5\n-11\n-8\n+1\n+6\n-12\n+7\n-16\n-8\n-12\n+15\n-5\n-16\n-10\n+7\n-5\n+12\n+15\n+4\n+5\n-4\n-16\n-17\n-5\n+13\n+16\n-12\n+10\n+18\n-17\n-20\n+13\n+2\n+20\n-7\n-12\n-5\n-10\n+17\n+24\n+15\n+1\n-7\n-18\n+6\n-16\n+15\n+18\n+15\n+24\n-7\n-6\n-30\n-8\n-8\n+4\n-38\n-12\n-6\n-8\n-12\n-14\n+8\n-18\n-5\n+14\n+12\n-15\n+2\n+3\n-14\n+17\n-18\n+16\n+7\n+3\n+7\n+12\n-16\n-9\n+16\n+8\n-17\n-16\n-80486")

(defn sum-frequencies
  {:test (fn []
           (is (= (sum-frequencies [1 1 1]) 3))
           (is (= (sum-frequencies [1 1 -2]) 0))
           (is (= (sum-frequencies [-1 -2 -3]) -6))
           (is (= (sum-frequencies (clean-input input)) 595)) ; part 1
           )}
  [changes]
  (apply + changes))

(defn first-two-frequency-occurrence
  {:test (fn []
           (is (= (first-two-frequency-occurrence [1 -2 3 1]) 2))
           (is (= (first-two-frequency-occurrence [3 3 4 -2 -4]) 10))
           (is (= (first-two-frequency-occurrence [-6 3 8 5 -6]) 5))
           (is (= (first-two-frequency-occurrence [7 7 -2 -7 -4]) 14))
           (is (= (first-two-frequency-occurrence (clean-input input)) 80598)) ; part 2
           )}
  [changes]
  (loop
    [current-freq 0 counter 1 seen #{}]
    (if (contains? seen current-freq)
      current-freq
      (recur
        (+ current-freq (circular-nth changes counter))
        (inc counter)
        (conj seen current-freq)))))
